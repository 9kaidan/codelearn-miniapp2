<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>CodeLearn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="app">

  <!-- HEADER -->
  <header class="topbar">
    <div class="profile">
      <div class="avatar">üë®‚Äçüíª</div>
      <div>
        <div class="username">–ü—Ä–∏–≤–µ—Ç, Developer</div>
        <div class="level">Level 3 ‚Ä¢ 120 XP</div>
      </div>
    </div>
    <button id="themeToggle" class="icon-btn">üåô</button>
  </header>

  <!-- –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ô –ö–û–ù–¢–ï–ù–¢ -->
  <main id="content" class="fade"></main>

  <!-- –ù–ò–ñ–ù–Ø–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
  <nav class="bottom-nav">
    <button data-page="home">üè†</button>
    <button data-page="learn">üìö</button>
    <button data-page="progress">üìä</button>
    <button data-page="profile">üë§</button>
  </nav>

</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase -->
<script>
  const SUPABASE_URL = "https://tqxlvczendomdhtfxymz.supabase.co";
  const SUPABASE_KEY = "sb_publishable_6Z40NqEsZ2h7KVzvkJJjjQ_yd1271ET";

  window.supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
</script>

<!-- 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Telegram -->
<script>
  if (!window.Telegram || !Telegram.WebApp) {
    document.body.innerHTML = "<h2>–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram</h2>";
    throw new Error("Not opened inside Telegram");
  }

  Telegram.WebApp.ready();

  const tgUser = Telegram.WebApp.initDataUnsafe?.user;

  if (!tgUser?.id) {
    document.body.innerHTML = "<h2>–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å Telegram ID</h2>";
    throw new Error("Telegram ID not found");
  }

  window.TELEGRAM_USER_ID = tgUser.id;
  window.TELEGRAM_USERNAME = tgUser.username || "Developer";
</script>

<!-- 4. –ü–æ–¥–∫–ª—é—á–∞–µ–º app.js –û–î–ò–ù –†–ê–ó –∏ –í –°–ê–ú–û–ú –ö–û–ù–¶–ï -->
<script type="module" src="js/app.js"></script>

</body>
</html>
